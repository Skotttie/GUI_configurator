<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>test model-viewer</title>
  <link rel="stylesheet" href="teststyle.css">
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
</head>
<body>

<a href="https://www.wsa.com/" target="_blank">
  <img src="data\wsa modelviewer logo.png" alt="Logo" id="logo">
</a>

<div id="controls">
  <label>Datei auswählen:
    <input type="file" id="fileInput" accept=".glb">
  </label>
  <button id="resetBtn">Ansicht zurücksetzen</button>
  <button id="selectBtn">Auswahl bestätigen</button>
</div>

<div id="sidebarContainer">
  <div id="sidebar">
    <button id="toggleSidebar">⯈ Optionen</button>
    <div id="sidebarContent">
      <lable>
        Hintergrundfarbe ändern:
        <input type="color" id="colorPicker">
      </lable>
      <label>
        AutoRotation:
        <input type="checkbox" id="autoRotateToggle">
      </label>
    </div>
  </div>

<div id="viewerContainer">
<!--  <img src="data\vollbild icon.png" id="fullscreenImg" alt="Fullscreen" title="Fullscreen"> --> 
  <button id="fullscreenBtn">Vollbild</button>

  <model-viewer 
    id="viewer" 
    src="data\wsa circle logo.glb"
    alt="3D Modell" 
    camera-controls 
    auto-rotate 
    auto-rotate-delay="1000"
    rotation-per-second="30deg" 
    shadow-intensity="1">
  </model-viewer>
</div>

<script>
const fileInput = document.getElementById('fileInput');
const viewer = document.getElementById('viewer');
const resetBtn = document.getElementById('resetBtn');
const fullscreenBtn = document.getElementById('fullscreenBtn'); /* auf 'fullscreenImg' ändern wenn Img aktiviert werden soll */
const toggleSidebar = document.getElementById('toggleSidebar');
const sidebar = document.getElementById('sidebar');

// Variablen für die Startwerte
let startOrbit, startTarget, startFieldOfView;

// Wenn irgendein Modell geladen wird (egal ob Standard oder Upload)
viewer.addEventListener('load', () => {
  startOrbit = viewer.cameraOrbit;
  startTarget = viewer.cameraTarget;
  startFieldOfView = viewer.fieldOfView;
  console.log("Startwerte gespeichert:", startOrbit, startTarget, startFieldOfView);
});

// Upload von neuen Dateien
fileInput.addEventListener('change', (event) => {
  const file = event.target.files[0];
  if (!file) return;

  const url = URL.createObjectURL(file);
  viewer.src = url;
  viewer.autoRotate = true;

  viewer.addEventListener('load', () => {
    URL.revokeObjectURL(url);
  }, { once: true });
});

// Reset-Kamera
resetBtn.addEventListener('click', () => {
  if (startOrbit && startTarget && startFieldOfView) {
    viewer.cameraOrbit = startOrbit;
    viewer.cameraTarget = startTarget;
    viewer.fieldOfView = startFieldOfView;
    viewer.jumpCameraToGoal();
    console.log("Reset ausgeführt");
  } else {
    console.log("Noch keine Startwerte gespeichert!");
  }
});

// VollbildButton
fullscreenBtn.addEventListener('click', () => {
  if (!document.fullscreenElement) {
    viewer.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
})

// Sidebar
toggleSidebar.addEventListener('click', () => {
  sidebar.classList.toggle('open');
  toggleSidebar.textContent = sidebar.classList.contains('open') 
    ? "⯆ Optionen" 
    : "⯈ Optionen";
});
</script>

</body>
</html>
